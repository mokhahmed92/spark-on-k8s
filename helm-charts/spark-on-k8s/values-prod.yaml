# Production values for spark-on-k8s
# Override default values for production deployment

# Global settings
global:
  createNamespaces: true

# Spark Operator configuration - Production settings
sparkOperator:
  enabled: true

# Volcano Scheduler configuration - Production
volcano:
  enabled: true
  
  custom:
    controller:
      replicas: 2  # HA
    
    scheduler:
      replicas: 2  # HA
      configuration:
        actions: "enqueue, allocate, backfill"
        tiers:
        - plugins:
          - name: priority
          - name: gang
          - name: conformance
        - plugins:
          - name: drf
          - name: predicates
          - name: proportion
          - name: nodeorder
          - name: binpack
    
    admission:
      enabled: true
      replicas: 2  # HA

  batchScheduler:
    enable: true

  controller:
    replicas: 2  # HA configuration
    workers: 20  # Increased workers for higher throughput
    logLevel: info
    resources:
      limits:
        cpu: 500m
        memory: 1Gi
      requests:
        cpu: 200m
        memory: 500Mi

  webhook:
    enable: true
    port: 9443
    resources:
      limits:
        cpu: 200m
        memory: 500Mi
      requests:
        cpu: 100m
        memory: 300Mi

  metrics:
    enable: true
    port: 8080
    endpoint: /metrics

  serviceAccounts:
    spark:
      create: false
    sparkoperator:
      create: true
      name: spark-operator

  leaderElection:
    enable: true
    lockName: spark-operator-lock
    lockNamespace: spark-operator

  resourceQuotaEnforcement:
    enable: false

# Production team configurations with higher resources
teams:
  defaultScheduler:
    - name: team-alpha
      displayName: "Team Alpha - Production"
      labels:
        team: team-alpha-id
        environment: production
      serviceAccount:
        name: team-alpha-sa
      resourceQuota:
        enabled: true
        requests:
          cpu: "8"
          memory: "16Gi"
        limits:
          cpu: "16"
          memory: "32Gi"
        pods: "20"

    - name: team-beta
      displayName: "Team Beta - Production"
      labels:
        team: team-beta-id
        environment: production
      serviceAccount:
        name: team-beta-sa
      resourceQuota:
        enabled: true
        requests:
          cpu: "8"
          memory: "16Gi"
        limits:
          cpu: "16"
          memory: "32Gi"
        pods: "20"

  volcanoScheduler:
    - name: team-theta
      displayName: "Team Theta - Production"
      labels:
        team: team-theta-id
        environment: production
      serviceAccount:
        name: team-theta-sa
      queue:
        name: queue-theta
        weight: 40
        capability:
          cpu: "16000m"
          memory: "32Gi"
        guarantee:
          cpu: "8000m"
          memory: "16Gi"
        reclaimable: true
      resourceQuota:
        enabled: true
        requests:
          cpu: "12"
          memory: "24Gi"
        limits:
          cpu: "16"
          memory: "32Gi"
        pods: "30"
        persistentvolumeclaims: "10"

    - name: team-delta
      displayName: "Team Delta - Production"
      labels:
        team: team-delta-id
        environment: production
      serviceAccount:
        name: team-delta-sa
      queue:
        name: queue-delta
        weight: 40
        capability:
          cpu: "16000m"
          memory: "32Gi"
        guarantee:
          cpu: "8000m"
          memory: "16Gi"
        reclaimable: true
      resourceQuota:
        enabled: true
        requests:
          cpu: "12"
          memory: "24Gi"
        limits:
          cpu: "16"
          memory: "32Gi"
        pods: "30"
        persistentvolumeclaims: "10"

    - name: ds-team-ns
      displayName: "Data Science Team - Production"
      labels:
        team: ds-team-id
        environment: production
      serviceAccount:
        name: ds-team-sa
      queue:
        name: batch-jobs-queue
        shared: true
      resourceQuota:
        enabled: false

    - name: de-team-ns
      displayName: "Data Engineering Team - Production"
      labels:
        team: de-team-id
        environment: production
      serviceAccount:
        name: de-team-sa
      queue:
        name: batch-jobs-queue
        shared: true
      resourceQuota:
        enabled: false

# Production queue configurations
queues:
  individual:
    - name: queue-theta
      weight: 40
      capability:
        cpu: "16000m"
        memory: "32Gi"
      guarantee:
        cpu: "8000m"
        memory: "16Gi"
      reclaimable: true

    - name: queue-delta
      weight: 40
      capability:
        cpu: "16000m"
        memory: "32Gi"
      guarantee:
        cpu: "8000m"
        memory: "16Gi"
      reclaimable: true

  shared:
    - name: batch-jobs-queue
      weight: 100
      capability:
        cpu: "32000m"
        memory: "64Gi"
      guarantee:
        cpu: "16000m"
        memory: "32Gi"
      reclaimable: true

  default:
    name: default
    weight: 20
    capability:
      cpu: "8000m"
      memory: "16Gi"
    reclaimable: false

# Production labels
commonLabels:
  app.kubernetes.io/managed-by: Helm
  app.kubernetes.io/part-of: spark-on-k8s
  environment: production

commonAnnotations:
  managed-by: "platform-team"
  contact: "platform-team@example.com"
